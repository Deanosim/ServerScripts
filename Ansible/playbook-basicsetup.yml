---
- name: Install Python
  hosts: all
  gather_facts: no
  become: true

  pre_tasks:
    - name: Install python for Ansible to work.
      raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)
      changed_when: false

  tasks:
    #- name: Insert UFW Docker fix at the end of after.rules file
     # lineinfile:
      #  path: /etc/ufw/after.rules
       # line: last
     - name: download program/script from https://github.com/chaifeng/ufw-docker and install to /usr/local/bin/ufw-docker then chmod +x
       become: yes
       get_url:
         backup: yes
         dest: /usr/local/bin/ufw-docker
         mode: +x
         url: https://github.com/chaifeng/ufw-docker/raw/master/ufw-docker

     - name: run ufw-docker install command
       command: ufw-docker install
       become: yes

     - name: apt update and upgrade
       apt:
         update_cache: yes
         name: "*"
         state: latest